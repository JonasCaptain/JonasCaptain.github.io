<!DOCTYPE html><html lang="en" class="astro-H24362AN">
  <head>
    <title>MySQL索引</title>
<meta charset="UTF-8">

<meta name="author" content="gwalnut">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="Blog,Astro">
<meta name="description" content="主要摘抄至出版书籍">
<meta name="category" content="Blog">
<link rel="canonical" href="https://jonascaptain.github.io/blog/articles/MySQLIndex/">
<meta name="generator" content="Astro v1.1.1">

<!-- Robot.txt -->
<meta name="robots" content="index,follow">
<meta name="Googlebot" content="index,follow">
<meta name="AdsBot-Google" content="index,follow">

<!-- FaceBook Meta data -->
<meta property="og:site_name" content="https://jonascaptain.github.io/blog/articles/MySQLIndex/">
<meta property="og:title" content="MySQL索引">
<meta property="og:description" content="主要摘抄至出版书籍">
<meta property="og:type" content="website">
<meta property="og:url" content="https://jonascaptain.github.io/blog/articles/MySQLIndex/">

<!-- Twitter Meta data -->
<meta name="twitter:card" content="My personal blog">
<meta name="twitter:url" content="https://jonascaptain.github.io/blog/articles/MySQLIndex/">
<meta name="twitter:title" content="MySQL索引">
<meta name="twitter:site" content="https://jonascaptain.github.io/blog/articles/MySQLIndex/">
<meta name="application-name" content="MySQL索引">
<meta name="twitter:description" content="主要摘抄至出版书籍">

<meta name="apple-mobile-web-app-title" content="MySQL索引">
<meta name="apple-touch-icon" content="/favicon.ico">
<meta name="summary" content="My personal blog">

<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

<script>
  if (localStorage.theme === 'night' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
    document.querySelector('html').setAttribute('data-theme', 'night');
  } else {
    document.querySelector('html').setAttribute('data-theme', 'cmyk');
  }
</script>
  <link rel="stylesheet" href="/assets/50c6c343.ed30341b.css" />
<link rel="stylesheet" href="/assets/d5e0e75b.7bb9d23f.css" />
<link rel="stylesheet" href="/assets/5b4135e6.e480e920.css" /><script type="module" src="/hoisted.b525123c.js"></script></head>

  <body class="astro-H24362AN">
    <a href="#main" class="absolute bg-info text-info-content px-6 py-2 rounded-br-md translate-x-[-100%] focus-within:translate-x-0 transition-all astro-H24362AN">Skip navigation</a>
    <header class="container mx-auto flex items-center justify-between mb-16 astro-H24362AN">
      <div class="p-4 astro-H24362AN">
        <!-- Logo -->
        <svg width="84" height="37" viewBox="0 0 84 37" fill="none" xmlns="http://www.w3.org/2000/svg" class="astro-H24362AN">
          <path d="M26.5625 23.2266C26.5625 25.1953 26.2266 26.9922 25.5547 28.6172C24.8828 30.2422 23.9688 31.6406 22.8125 32.8125C21.6562 33.9688 20.2969 34.8672 18.7344 35.5078C17.1875 36.1484 15.5234 36.4688 13.7422 36.4688C11.9766 36.4688 10.3125 36.1406 8.75 35.4844C7.20312 34.8281 5.84375 33.9141 4.67188 32.7422C3.51562 31.5703 2.60156 30.1797 1.92969 28.5703C1.25781 26.9453 0.921875 25.1641 0.921875 23.2266V0.914062H7.34375V12.6328C7.6875 12.1953 8.10156 11.8047 8.58594 11.4609C9.08594 11.1172 9.61719 10.8359 10.1797 10.6172C10.7578 10.3984 11.3516 10.2344 11.9609 10.125C12.5703 10 13.1641 9.9375 13.7422 9.9375C15.5234 9.9375 17.1875 10.2734 18.7344 10.9453C20.2969 11.6016 21.6562 12.5234 22.8125 13.7109C23.9688 14.8984 24.8828 16.3047 25.5547 17.9297C26.2266 19.5391 26.5625 21.3047 26.5625 23.2266ZM20.1172 23.2266C20.1172 22.2578 19.9453 21.3594 19.6016 20.5312C19.2734 19.6875 18.8203 18.9609 18.2422 18.3516C17.6641 17.7422 16.9844 17.2656 16.2031 16.9219C15.4375 16.5781 14.6172 16.4062 13.7422 16.4062C12.8672 16.4062 12.0391 16.6016 11.2578 16.9922C10.4922 17.3672 9.82031 17.875 9.24219 18.5156C8.66406 19.1406 8.21094 19.8672 7.88281 20.6953C7.55469 21.5078 7.39062 22.3516 7.39062 23.2266C7.39062 24.1953 7.55469 25.0938 7.88281 25.9219C8.21094 26.75 8.66406 27.4688 9.24219 28.0781C9.82031 28.6875 10.4922 29.1719 11.2578 29.5312C12.0391 29.875 12.8672 30.0469 13.7422 30.0469C14.6172 30.0469 15.4375 29.875 16.2031 29.5312C16.9844 29.1719 17.6641 28.6875 18.2422 28.0781C18.8203 27.4688 19.2734 26.75 19.6016 25.9219C19.9453 25.0938 20.1172 24.1953 20.1172 23.2266ZM54.3828 23.2266C54.3828 25.1016 54.0469 26.8516 53.375 28.4766C52.7031 30.0859 51.7891 31.4844 50.6328 32.6719C49.4766 33.8438 48.1172 34.7734 46.5547 35.4609C45.0078 36.1328 43.3438 36.4688 41.5625 36.4688C39.7969 36.4688 38.1328 36.1328 36.5703 35.4609C35.0234 34.7734 33.6641 33.8438 32.4922 32.6719C31.3359 31.4844 30.4219 30.0859 29.75 28.4766C29.0781 26.8516 28.7422 25.1016 28.7422 23.2266C28.7422 21.3203 29.0781 19.5547 29.75 17.9297C30.4219 16.3047 31.3359 14.9062 32.4922 13.7344C33.6641 12.5469 35.0234 11.6172 36.5703 10.9453C38.1328 10.2734 39.7969 9.9375 41.5625 9.9375C43.3438 9.9375 45.0078 10.2578 46.5547 10.8984C48.1172 11.5234 49.4766 12.4219 50.6328 13.5938C51.7891 14.75 52.7031 16.1484 53.375 17.7891C54.0469 19.4141 54.3828 21.2266 54.3828 23.2266ZM47.9375 23.2266C47.9375 22.1953 47.7656 21.2656 47.4219 20.4375C47.0938 19.5938 46.6406 18.875 46.0625 18.2812C45.4844 17.6719 44.8047 17.2109 44.0234 16.8984C43.2578 16.5703 42.4375 16.4062 41.5625 16.4062C40.6875 16.4062 39.8594 16.5703 39.0781 16.8984C38.3125 17.2109 37.6406 17.6719 37.0625 18.2812C36.5 18.875 36.0547 19.5938 35.7266 20.4375C35.3984 21.2656 35.2344 22.1953 35.2344 23.2266C35.2344 24.1953 35.3984 25.0938 35.7266 25.9219C36.0547 26.75 36.5 27.4688 37.0625 28.0781C37.6406 28.6875 38.3125 29.1719 39.0781 29.5312C39.8594 29.875 40.6875 30.0469 41.5625 30.0469C42.4375 30.0469 43.2578 29.8828 44.0234 29.5547C44.8047 29.2266 45.4844 28.7656 46.0625 28.1719C46.6406 27.5781 47.0938 26.8594 47.4219 26.0156C47.7656 25.1719 47.9375 24.2422 47.9375 23.2266ZM83.0469 23.2266C83.0469 25.1953 82.7109 26.9922 82.0391 28.6172C81.3672 30.2422 80.4531 31.6406 79.2969 32.8125C78.1406 33.9688 76.7812 34.8672 75.2188 35.5078C73.6719 36.1484 72.0078 36.4688 70.2266 36.4688C68.4609 36.4688 66.7969 36.1406 65.2344 35.4844C63.6875 34.8281 62.3281 33.9141 61.1562 32.7422C60 31.5703 59.0859 30.1797 58.4141 28.5703C57.7422 26.9453 57.4062 25.1641 57.4062 23.2266V0.914062H63.8281V12.6328C64.1719 12.1953 64.5859 11.8047 65.0703 11.4609C65.5703 11.1172 66.1016 10.8359 66.6641 10.6172C67.2422 10.3984 67.8359 10.2344 68.4453 10.125C69.0547 10 69.6484 9.9375 70.2266 9.9375C72.0078 9.9375 73.6719 10.2734 75.2188 10.9453C76.7812 11.6016 78.1406 12.5234 79.2969 13.7109C80.4531 14.8984 81.3672 16.3047 82.0391 17.9297C82.7109 19.5391 83.0469 21.3047 83.0469 23.2266ZM76.6016 23.2266C76.6016 22.2578 76.4297 21.3594 76.0859 20.5312C75.7578 19.6875 75.3047 18.9609 74.7266 18.3516C74.1484 17.7422 73.4688 17.2656 72.6875 16.9219C71.9219 16.5781 71.1016 16.4062 70.2266 16.4062C69.3516 16.4062 68.5234 16.6016 67.7422 16.9922C66.9766 17.3672 66.3047 17.875 65.7266 18.5156C65.1484 19.1406 64.6953 19.8672 64.3672 20.6953C64.0391 21.5078 63.875 22.3516 63.875 23.2266C63.875 24.1953 64.0391 25.0938 64.3672 25.9219C64.6953 26.75 65.1484 27.4688 65.7266 28.0781C66.3047 28.6875 66.9766 29.1719 67.7422 29.5312C68.5234 29.875 69.3516 30.0469 70.2266 30.0469C71.1016 30.0469 71.9219 29.875 72.6875 29.5312C73.4688 29.1719 74.1484 28.6875 74.7266 28.0781C75.3047 27.4688 75.7578 26.75 76.0859 25.9219C76.4297 25.0938 76.6016 24.1953 76.6016 23.2266Z" fill="#FF0000" class="astro-H24362AN"></path>
        </svg>
      </div>

      <label aria-label="Hamburger Menu" id="nav-toggle" class="btn btn-circle swap swap-rotate fixed z-[999] top-4 right-4 hidden astro-H24362AN" aria-controls="primary-nav" aria-expanded="false">
        <input type="checkbox" class="astro-H24362AN">
        <!-- hamburger icon -->
        <svg class="swap-off fill-current astro-H24362AN" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512">
          <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" class="astro-H24362AN"></path>
        </svg>
        <!-- close icon -->
        <svg class="swap-on fill-current astro-H24362AN" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512">
          <polygon points="400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49" class="astro-H24362AN"></polygon>
        </svg>
      </label>

      <nav class="mr-6 astro-H24362AN">
        <ul id="primary-nav" class="flex grow gap-8 items-center justify-center z-[100] astro-H24362AN" data-visible="false">
          <li class="after:block after:mx-auto after:h-[0.15em] after:bottom-0 after:w-0 after:bg-green-700 dark:after:bg-amber-400 after:transition-[all_ease_in_out_300ms] after:mt-1 hover:after:w-full astro-6PA5N7LT">
  <a href="/" class="flex hover:text-black dark:hover:text-white p-1 astro-6PA5N7LT">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
    <span class="pl-2 pointer-events-none astro-6PA5N7LT">Home</span>
  </a>
</li><li class="after:block after:mx-auto after:h-[0.15em] after:bottom-0 after:w-0 after:bg-green-700 dark:after:bg-amber-400 after:transition-[all_ease_in_out_300ms] after:mt-1 hover:after:w-full astro-6PA5N7LT">
  <a href="/blog/" class="flex hover:text-black dark:hover:text-white p-1 astro-6PA5N7LT">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
    <span class="pl-2 pointer-events-none astro-6PA5N7LT">Blog</span>
  </a>
</li><li class="after:block after:mx-auto after:h-[0.15em] after:bottom-0 after:w-0 after:bg-green-700 dark:after:bg-amber-400 after:transition-[all_ease_in_out_300ms] after:mt-1 hover:after:w-full astro-6PA5N7LT">
  <a href="/search/" class="flex hover:text-black dark:hover:text-white p-1 astro-6PA5N7LT">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
    <span class="pl-2 pointer-events-none astro-6PA5N7LT">Search</span>
  </a>
</li><li class="after:block after:mx-auto after:h-[0.15em] after:bottom-0 after:w-0 after:bg-green-700 dark:after:bg-amber-400 after:transition-[all_ease_in_out_300ms] after:mt-1 hover:after:w-full astro-6PA5N7LT">
  <a href="/tags/" class="flex hover:text-black dark:hover:text-white p-1 astro-6PA5N7LT">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" /></svg>
    <span class="pl-2 pointer-events-none astro-6PA5N7LT">Tags</span>
  </a>
</li>
          <li class="astro-H24362AN">
            <!-- Theme, Light/Dark mode -->
            <label id="themeSetting" class="swap swap-rotate astro-H24362AN">
              <!-- this hidden checkbox controls the state -->
              <input type="checkbox" class="astro-H24362AN">
              <!-- sun icon -->
              <svg data-set-theme="cmyk" data-act-class="ACTIVECLASS" class="swap-on fill-current w-6 h-6 astro-H24362AN" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z" class="astro-H24362AN"></path>
              </svg>
              <!-- moon icon -->
              <svg data-set-theme="night" data-act-class="ACTIVECLASS" class="swap-off fill-current w-6 h-6 astro-H24362AN" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z" class="astro-H24362AN"></path>
              </svg>
            </label>
          </li>
        </ul>
      </nav>
    </header>
    <main id="main" class="container mx-auto astro-H24362AN">
      <h1 class="text-3xl md:text-5xl 2xl:text-6xl mb-[0.8em] font-extrabold mx-auto w-fit">MySQL索引</h1><div class="flex flex-wrap justify-evenly mb-9 mt-2">
    <div>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <time datetime="2023-02-20T10:00:00.000Z">20 February 2023</time>
    </div>

    <div class="flex flex-wrap gap-2">
      <a class="p-[clamp(0.25rem,_0.25em,_0.5em)_0.5em] rounded-md text-stone-600 hover:text-stone-800 dark:text-stone-300 dark:hover:text-stone-100 astro-ZIEHN457" style="--tag-bg: #3CA5EA1a;--tag-prefix: #3CA5EA;" href="/tags/MySQL/">MySQL</a><a class="p-[clamp(0.25rem,_0.25em,_0.5em)_0.5em] rounded-md text-stone-600 hover:text-stone-800 dark:text-stone-300 dark:hover:text-stone-100 astro-ZIEHN457" style="--tag-bg: #3CA5EA1a;--tag-prefix: #3CA5EA;" href="/tags/Index/">Index</a><a class="p-[clamp(0.25rem,_0.25em,_0.5em)_0.5em] rounded-md text-stone-600 hover:text-stone-800 dark:text-stone-300 dark:hover:text-stone-100 astro-ZIEHN457" style="--tag-bg: #3CA5EA1a;--tag-prefix: #3CA5EA;" href="/tags/索引/">索引</a>
    </div>
  </div><div class="prose md:prose-lg 2xl:prose-xl px-4 mx-auto prose-pre:font-mono">
    <h2 id="索引">索引</h2>
<h3 id="简介">简介</h3>
<p>索引有两种，一种是BTree索引，一种是Hash索引</p>
<h3 id="分类">分类</h3>
<ol>
<li>普通索引：不添加任何限制条件</li>
<li>唯一性索引：使用Unique参数，确保该字段中所有的value具有唯一性</li>
<li>全文索引：使用FullText参数，只能创建在Char、VarChar、Text类型的字段上，只有MyISAM存储引擎支持全文索引</li>
<li>单列索引：在一个字段上建立的普通索引，唯一性索引或全文索引</li>
<li>多列索引：在多个字段上建立的普通索引，唯一性索引或全文索引</li>
<li>空间索引：使用Spatial参数，只有MyISAM存储引擎支持空间索引，必须建立在空间数据类型上，且必须非空</li>
</ol>
<h4 id="索引的设计原则">索引的设计原则</h4>
<ol>
<li>
<p>选择唯一性索引</p>
</li>
<li>
<p>为经常需要排序、分组和联合操作的字段建立索引<br>
<code>如：order by、group by、distinct、union等操作的字段，特别是排序</code></p>
</li>
<li>
<p>为常作为查询条件的字段建立索引</p>
</li>
<li>
<p>限制索引的数目（避免过多的浪费空间）</p>
</li>
<li>
<p>尽量使用数据量少的索引</p>
</li>
<li>
<p>尽量使用前缀来索引<br>
<code>如：索引Text类型字段的前N个字符</code></p>
</li>
<li>
<p>删除不再使用或者很少使用的索引</p>
</li>
</ol>
<h4 id="创建索引">创建索引</h4>
<p>三种方式：</p>
<ul>
<li>创建表时创建索引(create table xxx 附带)</li>
<li>已经存在的表上创建索引(create index)</li>
<li>使用alter table语句来创建索引(alter table add index)</li>
</ul>
<h4 id="创建表时创建索引">创建表时创建索引</h4>
<pre is:raw="" class="astro-code" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #ABB2BF">## 普通索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index1(id </span><span style="color: #C678DD">int</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                    </span><span style="color: #C678DD">name</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">varchar</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">20</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">                       sex </span><span style="color: #C678DD">boolean</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                       </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF">(id));</span></span>
<span class="line"><span style="color: #ABB2BF">## 唯一性索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index2(id </span><span style="color: #C678DD">int</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">unique</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                       </span><span style="color: #C678DD">name</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">varchar</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">20</span><span style="color: #ABB2BF">));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index2(id </span><span style="color: #C678DD">int</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                       </span><span style="color: #C678DD">name</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">varchar</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">20</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">                    </span><span style="color: #C678DD">unique</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index2_id(id </span><span style="color: #C678DD">ASC</span><span style="color: #ABB2BF">));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">## 全文索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index3(id </span><span style="color: #C678DD">int</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                   info </span><span style="color: #C678DD">varchar</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">20</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">                   </span><span style="color: #C678DD">fulltext</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index3_info(info))</span></span>
<span class="line"><span style="color: #ABB2BF">                   engine</span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF">MyISAM;</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建单列索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index4(id </span><span style="color: #C678DD">int</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                       </span><span style="color: #C678DD">subject</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">varchar</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">30</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">                       </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index4_st(</span><span style="color: #C678DD">subject</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">)));</span></span>
<span class="line"><span style="color: #ABB2BF">                       </span><span style="color: #ABB2BF">## 只索引subject前10个字符</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建多列索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index5(id </span><span style="color: #C678DD">int</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                       </span><span style="color: #C678DD">name</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">varchar</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">20</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">                       sex </span><span style="color: #C678DD">char</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">4</span><span style="color: #ABB2BF">),</span></span>
<span class="line"><span style="color: #ABB2BF">                       </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index5_ns(</span><span style="color: #C678DD">name</span><span style="color: #ABB2BF">, sex));</span></span>
<span class="line"><span style="color: #ABB2BF">explain </span><span style="color: #C678DD">select</span><span style="color: #ABB2BF"> * </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> index5 </span><span style="color: #C678DD">where</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">name</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'123'</span><span style="color: #ABB2BF">\G;</span></span>
<span class="line"><span style="color: #ABB2BF">explain </span><span style="color: #C678DD">select</span><span style="color: #ABB2BF"> * </span><span style="color: #C678DD">from</span><span style="color: #ABB2BF"> index5 </span><span style="color: #C678DD">where</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">name</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'123'</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">and</span><span style="color: #ABB2BF"> sex </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #98C379">'N'</span><span style="color: #ABB2BF">\G;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">## 创建空间索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index6(id </span><span style="color: #C678DD">int</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                       </span><span style="color: #56B6C2">space</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">geometry</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">not</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">null</span><span style="color: #ABB2BF">,</span></span>
<span class="line"><span style="color: #ABB2BF">                   </span><span style="color: #C678DD">spatial</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index6_sp(</span><span style="color: #56B6C2">space</span><span style="color: #ABB2BF">))</span></span>
<span class="line"><span style="color: #ABB2BF">                   engine</span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF">MyISAM;</span></span></code></pre>
<h4 id="在已经存在的表上创建索引">在已经存在的表上创建索引</h4>
<pre is:raw="" class="astro-code" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #C678DD">CREATE</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">[UNIQUE|FULLTEXT|SPATIAL]</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">INDEX</span><span style="color: #ABB2BF"> 索引名 </span><span style="color: #C678DD">ON</span><span style="color: #ABB2BF"> 表名(属性名</span><span style="color: #E06C75">[(长度)]</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">[ASC|DESC]</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">## 创建普通索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index7_id </span><span style="color: #C678DD">on</span><span style="color: #ABB2BF"> index7(id);</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建唯一性索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">unique</span><span style="color: #ABB2BF"> index8_id </span><span style="color: #C678DD">on</span><span style="color: #ABB2BF"> index8(course_id);</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建全文索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">fulltext</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index9_info </span><span style="color: #C678DD">on</span><span style="color: #ABB2BF"> index9(info);</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建单列索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index10_addr </span><span style="color: #C678DD">on</span><span style="color: #ABB2BF"> index10(</span><span style="color: #C678DD">address</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">4</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建多列索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index11_na </span><span style="color: #C678DD">on</span><span style="color: #ABB2BF"> index11(</span><span style="color: #C678DD">name</span><span style="color: #ABB2BF">, </span><span style="color: #C678DD">address</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建空间索引</span></span>
<span class="line"><span style="color: #C678DD">create</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">spatial</span><span style="color: #ABB2BF"> index12_line </span><span style="color: #C678DD">on</span><span style="color: #ABB2BF"> index12(</span><span style="color: #C678DD">line</span><span style="color: #ABB2BF">);</span></span></code></pre>
<h4 id="用alter-table语句创建索引">用alter table语句创建索引</h4>
<pre is:raw="" class="astro-code" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #C678DD">ALTER</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">TABLE</span><span style="color: #ABB2BF"> 表名 </span><span style="color: #C678DD">ADD</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">[UNIQUE|FULLTEXT|SPATIAL]</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">INDEX</span><span style="color: #ABB2BF"> 索引名 (属性名</span><span style="color: #E06C75">[(长度)]</span><span style="color: #ABB2BF"> </span><span style="color: #E06C75">[ASC|DESC]</span><span style="color: #ABB2BF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">## 创建普通索引</span></span>
<span class="line"><span style="color: #C678DD">alter</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index13 </span><span style="color: #C678DD">add</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index13_name(</span><span style="color: #C678DD">name</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">20</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建唯一性索引</span></span>
<span class="line"><span style="color: #C678DD">alter</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index14 </span><span style="color: #C678DD">add</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">unique</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index14_id(course_id);</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建全文索引</span></span>
<span class="line"><span style="color: #C678DD">alter</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index15 </span><span style="color: #C678DD">add</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">fulltext</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index15_info(info);</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建单列索引</span></span>
<span class="line"><span style="color: #C678DD">alter</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index16 </span><span style="color: #C678DD">add</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index16_addr(</span><span style="color: #C678DD">address</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">4</span><span style="color: #ABB2BF">));</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建多列索引</span></span>
<span class="line"><span style="color: #C678DD">alter</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index17 </span><span style="color: #C678DD">add</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index17_na(</span><span style="color: #C678DD">name</span><span style="color: #ABB2BF">, </span><span style="color: #C678DD">address</span><span style="color: #ABB2BF">);</span></span>
<span class="line"><span style="color: #ABB2BF">## 创建空间索引</span></span>
<span class="line"><span style="color: #C678DD">alter</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">table</span><span style="color: #ABB2BF"> index18 </span><span style="color: #C678DD">add</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">spatial</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> index18_line(</span><span style="color: #C678DD">line</span><span style="color: #ABB2BF">);</span></span></code></pre>
<h4 id="删除索引">删除索引</h4>
<pre is:raw="" class="astro-code" style="background-color: #282c34; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #C678DD">drop</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> 索引名 </span><span style="color: #C678DD">on</span><span style="color: #ABB2BF"> 表名;</span></span>
<span class="line"><span style="color: #C678DD">drop</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">index</span><span style="color: #ABB2BF"> id </span><span style="color: #C678DD">on</span><span style="color: #ABB2BF"> index1;</span></span></code></pre>
<h3 id="btree索引和hash索引的区别">B+Tree索引和Hash索引的区别</h3>
<h4 id="特点">特点</h4>
<ul>
<li>Hash索引结构的特殊性，其检索效率非常高，索引的检索可以一次定位</li>
<li>B+Tree索引需要从根节点到枝节点，最后才能访问到叶节点这样多次的<strong>IO</strong>访问</li>
</ul>
<h4 id="为什么不都用hash索引而使用btree索引">为什么不都用Hash索引而使用B+Tree索引？</h4>
<ol>
<li>Hash索引仅仅能满足“=”、“IN”和“”查询，不能使用范围查询，因为经过相应的Hash算法处理之后的Hash值的大小关系，并不能保证和Hash运算前完全一样</li>
<li>Hash索引无法被用来避免数据的排序操作，因为Hash值的大小关系并不一定和Hash运算前的键值完全一样</li>
<li>Hash索引不能利用部分索引键查询，对于组合索引，Hash索引在计算Hash值的时候，是组合索引键合并后再一起计算Hash值，而不是单独的计算Hash值，所以通过组合索引的前面一个或几个索引键进行查询的时候，Hash索引也无法被利用</li>
<li>Hash索引在任何时候都不能避免表扫描，由于不同索引键存在相同Hash值，所以即使满足某个Hash键值数据的记录条数，也无法从Hash索引中直接完成查询，还是要回表查询数据</li>
<li>Hash索引遇到大量Hash值相等的情况后性能并不一定就会比B+Tree索引高</li>
</ol>
<h4 id="补充">补充</h4>
<ol>
<li>MySQL中，只有HEAP/MEMORY引擎才显式支持Hash索引</li>
<li>常用的<strong>InnoDB</strong>引擎中默认使用的是B+Tree索引，它会实时监控表上索引的使用情况，如果认为建立Hash索引可以提高查询效率，则自动在内存中的“自适应Hash索引缓冲区”建立Hash索引(在InnoDB中默认开启自适应Hash索引)，通过观察搜索模式，MySQL会利用index key的前缀建立Hash索引，入股过一个表几乎大部分都在缓冲池中，那么建立一个Hash索引能够加快等值查询</li>
<li>如果是等值查询，那么Hash索引明显有绝对优势，因为只需要经过一次算法即可找到相应的键值；当然了，这个前提是，键值都是唯一的。如果键值不是唯一的，就需要先找到该键所在的位置，然后再根据链表往后扫描，直到找到相应的数据</li>
<li>如果是范围查询检索，这时候Hash索引就毫无用武之地了，因为原先是有序的键值，经过Hash算法后，有可能变成不连续的了，就没办法再利用索引完成范围查询检索；同理Hash索引没办法利用索引完成排序，以及 like ‘xx%‘这样的部分模糊查询(这种部分模糊查询，本质上也是范围查询)</li>
<li>Hash索引不支持多列联合索引的最左匹配规则</li>
<li>B+Tree索引的关键字检索效率比较平均，不像BTree那样波动幅度大，在有大量重复键值情况下，Hash索引的效率也是极低的，因为存在所谓的Hash碰撞问题</li>
<li>在大多数场景下，都会有范围查询、排序、分组等查询特征，用B+Tree索引就可以了</li>
</ol>
<h4 id="btree与btree的区别">BTree与B+Tree的区别</h4>
<ul>
<li>BTree，每个节点存储Key和Data，所有节点组成这颗树，并且叶子节点指针为null，叶子节点不包含任何关键字信息</li>
<li>B+Tree，所有的叶子节点中包含了全部关键字的信息，及指向含有这些关键字记录的指针，且叶子节点本身依关键字的大小自小而大的顺序链接，所有的非终端节点可以看成是索引部分，节点中仅含有其子树根节点中最（或最小）关键字。（而BTree的非终节点也包含需要查找的有效信息）</li>
</ul>
<h4 id="为什么说btree比btree更适合实际应用中操作系统的文件索引和数据库索引">为什么说B+Tree比BTree更适合实际应用中操作系统的文件索引和数据库索引？</h4>
<ul>
<li>
<p>B+的磁盘读写代价更低</p>
<p>B+的内部节点并没有指向关键字具体信息的指针。因此其内部节点相对BTree更小。如果把所有同一内部节点的关键字存放在同一块盘中，那么盘所能容纳的关键字数量也越多。一次性读入内存中的需要查找的关键字也就越多。相对来说IO读写次数也就降低了。</p>
</li>
<li>
<p>B+Tree的查询效率更加稳定</p>
<p>由于非终节点并不是最终指向文件内容的节点，而只是叶子节点中的关键字的索引。所以任何关键字的查找必须走一条从根节点到叶子节点的路。所有关键字查询的路径长度相同，导致每一个数据的查询效率相当。</p>
</li>
</ul>
<h3 id="聚簇索引和非聚簇索引的区别">聚簇索引和非聚簇索引的区别</h3>
<ol>
<li>
<p>聚簇索引(clustered index):</p>
<p>聚簇索引表记录的排列顺序和索引的排列顺序一致，所以查询效率快，只要找到第一个索引值记录，其余就连续性的记录在物理也一样连续存放。聚簇索引的对应的缺点就是修改慢，因为为了保证表中记录的物理和索引顺序一致，在记录插入的时候，会对数据页重新排序。</p>
<p>聚簇索引类似于新华字典总用拼音去查找汉字，拼音检索表的顺序都是按照a~z排列的，就想相同的逻辑顺序与物理顺序一样，当你需要查找a,ai两个读音的字，或是想一次寻找多个sha的同音字时，也许向后翻几页，或紧接着下一行就得到结果了。</p>
</li>
<li>
<p>非聚簇索引(nonclustered index):</p>
<p>非聚簇索引指定了表中记录的逻辑顺序，但是记录的物理和索引不一定一致，两种索引都采用B+Tree结构，非聚簇索引的叶子层并不和实际数据页相重叠，而采用叶子层包含一个指向表中的记录在数据页中的指针方式。非聚簇索引层次多，不会造成数据重排。</p>
<p>非聚簇索引类似在新华字典上通过偏旁部首来查询汉字，检索表也是按照横、竖、撇来排列的，但是由于正文中是a~z的拼音顺序，所以就类似于逻辑地址与物理地址的不对应。同时适用的情况就在于分组，大数目的不同值，频繁更新的列中，这些情况即不适合聚簇索引。</p>
</li>
</ol>
<p><strong>根本区别</strong>：</p>
<p>聚簇索引和非聚簇索引的根本区别是表记录的排列顺序和与索引的排列顺序是否一致。</p>
  </div>
    </main>

    <svg xmlns="http://www.w3.org/2000/svg" id="scrollButton" viewBox="0 0 512 512" class="w-10 h-10 fill-primary fixed bottom-5 right-5 animate-[jump_1500ms_infinite] cursor-pointer bg-base-100 rounded-full astro-H24362AN" style="display: none">
      <path d="M256 0C114.6 0 0 114.6 0 256c0 141.4 114.6 256 256 256s256-114.6 256-256C512 114.6 397.4 0 256 0zM382.6 254.6c-12.5 12.5-32.75 12.5-45.25 0L288 205.3V384c0 17.69-14.33 32-32 32s-32-14.31-32-32V205.3L174.6 254.6c-12.5 12.5-32.75 12.5-45.25 0s-12.5-32.75 0-45.25l103.1-103.1C241.3 97.4 251.1 96 256 96c4.881 0 14.65 1.391 22.65 9.398l103.1 103.1C395.1 221.9 395.1 242.1 382.6 254.6z" class="astro-H24362AN"></path>
    </svg>

    <footer class="border-t px-4 py-6 mt-6 astro-H24362AN">
      <p class="text-center text-sm astro-H24362AN">
        &copy; 2023
        gwalnut
      </p>
      <p class="text-center text-xs astro-H24362AN">
        Built with <a class="text-cyan-600 hover:text-black dark:hover:text-white astro-H24362AN" href="https://astro.build" target="_blank" rel="noreferrer noopener">Astro v1.1.1
        </a>
      </p>
    </footer>
  </body>
</html>



